<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒÚ¯Ø± Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ ÙØ±ÙˆØ´ ÛŒÙˆØ¢Ù†</title>
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --primary: #4F46E5;
  --primary-light: #6366F1;
  --secondary: #10B981;
  --warning: #F59E0B;
  --danger: #EF4444;
  --bg: #F9FAFB;
  --card-bg: #FFFFFF;
  --text: #111827;
  --text-muted: #6B7280;
  --border: #E5E7EB;
  --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'Vazirmatn', Tahoma, Arial, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  background-attachment: fixed;
  color: var(--text);
  line-height: 1.6;
  padding: 20px 10px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
}

.header {
  background: var(--card-bg);
  border-radius: 16px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: var(--shadow);
  text-align: center;
}

.header h1 {
  font-size: 28px;
  color: var(--primary);
  margin-bottom: 8px;
  font-weight: 700;
}

.header .subtitle {
  font-size: 14px;
  color: var(--text-muted);
  margin-bottom: 8px;
}

.header .developer {
  font-size: 13px;
  color: var(--text-muted);
  font-weight: 600;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--border);
}

.header .clock {
  margin-top: 12px;
  font-size: 14px;
  color: var(--text-muted);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.grid {
  display: grid;
  grid-template-columns: repeat(12, 1fr);
  gap: 20px;
}

.card {
  background: var(--card-bg);
  border-radius: 16px;
  padding: 24px;
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
}

.card-title {
  font-size: 18px;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.card-icon {
  font-size: 24px;
}

.col-12 { grid-column: span 12; }
.col-6 { grid-column: span 6; }
.col-4 { grid-column: span 4; }
.col-3 { grid-column: span 3; }

@media (max-width: 768px) {
  .col-6, .col-4, .col-3 { grid-column: span 12; }
}

.form-group {
  margin-bottom: 16px;
}

.form-label {
  display: block;
  font-size: 14px;
  font-weight: 600;
  color: var(--text);
  margin-bottom: 6px;
}

.form-input, .form-select, .form-textarea {
  width: 100%;
  padding: 12px;
  border: 2px solid var(--border);
  border-radius: 10px;
  font-size: 15px;
  font-family: inherit;
  transition: all 0.3s;
  background: #FAFAFA;
}

.form-input:focus, .form-select:focus, .form-textarea:focus {
  outline: none;
  border-color: var(--primary);
  background: #FFFFFF;
  box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
}

.btn {
  padding: 12px 24px;
  border: none;
  border-radius: 10px;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  font-family: inherit;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  justify-content: center;
}

.btn-primary {
  background: linear-gradient(135deg, var(--primary), var(--primary-light));
  color: white;
  box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(79, 70, 229, 0.4);
}

.btn-secondary {
  background: linear-gradient(135deg, var(--secondary), #059669);
  color: white;
  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
}

.btn-secondary:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4);
}

.btn-warning {
  background: linear-gradient(135deg, var(--warning), #D97706);
  color: white;
  box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
}

.btn-warning:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(245, 158, 11, 0.4);
}

.btn-outline {
  background: transparent;
  border: 2px solid var(--border);
  color: var(--text);
}

.btn-outline:hover {
  background: var(--bg);
  border-color: var(--primary);
  color: var(--primary);
}

.btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none !important;
}

.market-display {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  flex-wrap: wrap;
}

.market-value {
  flex: 1;
}

.market-value .label {
  font-size: 13px;
  color: var(--text-muted);
  margin-bottom: 4px;
}

.market-value .value {
  font-size: 32px;
  font-weight: 700;
  color: var(--primary);
}

.market-value .source {
  font-size: 12px;
  color: var(--text-muted);
  margin-top: 4px;
}

.btn-group {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.result-box {
  background: linear-gradient(135deg, #EEF2FF, #E0E7FF);
  border-radius: 12px;
  padding: 16px;
  margin-top: 12px;
  border-left: 4px solid var(--primary);
}

.result-label {
  font-size: 13px;
  color: var(--text-muted);
  margin-bottom: 4px;
}

.result-value {
  font-size: 24px;
  font-weight: 700;
  color: var(--primary);
}

.status-badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: 600;
  margin-top: 8px;
}

.status-success {
  background: #D1FAE5;
  color: #065F46;
}

.status-warning {
  background: #FEF3C7;
  color: #92400E;
}

.status-danger {
  background: #FEE2E2;
  color: #991B1B;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 16px;
}

th, td {
  padding: 12px;
  text-align: right;
  border-bottom: 1px solid var(--border);
}

th {
  background: var(--bg);
  font-weight: 600;
  color: var(--text-muted);
  font-size: 13px;
}

td {
  font-size: 14px;
}

.toast {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: white;
  padding: 16px 20px;
  border-radius: 12px;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
  display: none;
  align-items: center;
  gap: 12px;
  z-index: 1000;
  animation: slideIn 0.3s ease;
}

@keyframes slideIn {
  from {
    transform: translateX(400px);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

.toast.show {
  display: flex;
}

.spinner {
  border: 3px solid #f3f3f3;
  border-top: 3px solid var(--primary);
  border-radius: 50%;
  width: 20px;
  height: 20px;
  animation: spin 1s linear infinite;
  display: inline-block;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.history-item {
  background: var(--bg);
  padding: 12px;
  border-radius: 8px;
  margin-bottom: 8px;
  font-size: 13px;
}

.history-item .time {
  color: var(--text-muted);
  font-size: 11px;
}

.row-2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

.row-3 {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 16px;
}

@media (max-width: 768px) {
  .row-2, .row-3 {
    grid-template-columns: 1fr;
  }
  .market-display {
    flex-direction: column;
  }
}

.print-only {
  display: none;
}

@media print {
  body {
    background: white;
    padding: 0;
  }
  .container {
    max-width: 100%;
  }
  .no-print {
    display: none !important;
  }
  .print-only {
    display: block !important;
  }
  .card {
    box-shadow: none;
    border: 1px solid #ddd;
    page-break-inside: avoid;
  }
}

.competitive-box {
  background: linear-gradient(135deg, #FEF3C7, #FDE68A);
  border-radius: 12px;
  padding: 16px;
  margin-top: 12px;
  border-left: 4px solid var(--warning);
}

.competitive-box.profit {
  background: linear-gradient(135deg, #D1FAE5, #A7F3D0);
  border-left-color: var(--secondary);
}

.competitive-box.loss {
  background: linear-gradient(135deg, #FEE2E2, #FECACA);
  border-left-color: var(--danger);
}
</style>
</head>
<body>

<div class="container">
  <!-- Header -->
  <div class="header no-print">
    <h1>ğŸ’° Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒÚ¯Ø± Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ ÙØ±ÙˆØ´ ÛŒÙˆØ¢Ù†</h1>
    <p class="subtitle">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ù‚ÛŒÙ‚ Ùˆ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ Ù†Ø±Ø® ØªØ¨Ø¯ÛŒÙ„ ÛŒÙˆØ¢Ù† Ø¨Ù‡ Ø±ÛŒØ§Ù„ Ùˆ ØªØªØ±</p>
    <div class="clock" id="clockDisplay">
      <span>ğŸ•</span>
      <span id="clock">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</span>
    </div>
    <div class="developer">
      ğŸ‘¨â€ğŸ’» Ø·Ø±Ø§Ø­ÛŒ Ùˆ ØªÙˆØ³Ø¹Ù‡: Ø¹Ù„ÛŒØ±Ø¶Ø§ Ø­Ø§Ù…Ø¯
    </div>
  </div>

  <div class="grid">
    <!-- Card 1: Market Rate -->
    <div class="card col-12 no-print">
      <div class="card-title">
        <span class="card-icon">ğŸ“Š</span>
        Ù†Ø±Ø® Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ Ø¨Ø§Ø²Ø§Ø± ØªØªØ± (ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ù…Ù‚Ø§ÛŒØ³Ù‡)
      </div>
      <div class="market-display">
        <div class="market-value">
          <div class="label">Ù‚ÛŒÙ…Øª ØªØªØ± Ø¨Ù‡ ØªÙˆÙ…Ø§Ù†</div>
          <div class="value" id="marketRate">â€”</div>
          <div class="source" id="marketSource">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± Ø¯Ø±ÛŒØ§ÙØª...</div>
          <div class="source" id="lastUpdate" style="margin-top: 8px;">Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: â€”</div>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" id="btnFetch">
            <span id="fetchIcon">ğŸ”„</span>
            Ø¯Ø±ÛŒØ§ÙØª Ù†Ø±Ø®
          </button>
          <button class="btn btn-outline" id="btnReset">
            â™»ï¸ Ø±ÛŒØ³Øª ÙØ±Ù…
          </button>
        </div>
      </div>
    </div>

    <!-- Card 2: Input Fields -->
    <div class="card col-12 no-print">
      <div class="card-title">
        <span class="card-icon">âœï¸</span>
        Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆØ±ÙˆØ¯ÛŒ
      </div>
      <div class="row-2">
        <div class="form-group">
          <label class="form-label">Ù…Ù‚Ø¯Ø§Ø± ÛŒÙˆØ¢Ù† (CNY)</label>
          <input type="number" class="form-input" id="inpCNY" value="6000" inputmode="decimal">
        </div>
        <div class="form-group">
          <label class="form-label">Ø±ÛŒØª ØªØªØ± Ø¨Ù‡ ÛŒÙˆØ¢Ù† (CNY / 1 USDT)</label>
          <input type="number" class="form-input" id="inpRateCNY" value="7.15" inputmode="decimal" step="0.01">
        </div>
      </div>
      <div class="row-2">
        <div class="form-group">
          <label class="form-label">Ø±ÛŒØª ØªØ¨Ø¯ÛŒÙ„ Ø¯Ù„Ø§Ø± Ø¨Ù‡ ØªØªØ±</label>
          <input type="number" class="form-input" id="inpUSDtoUSDT" value="1.014" inputmode="decimal" step="0.001">
        </div>
        <div class="form-group">
          <label class="form-label">Ù†Ø±Ø® Ø¯Ù„Ø§Ø± Ø¨Ù‡ ØªÙˆÙ…Ø§Ù†</label>
          <input type="number" class="form-input" id="inpUSDtoTMN" value="109800" inputmode="decimal">
        </div>
      </div>
      <div class="row-2">
        <div class="form-group">
          <label class="form-label">Ù†Ø±Ø® ØªØªØ± Ø¨Ù‡ ØªÙˆÙ…Ø§Ù† (Ø¯Ø³ØªÛŒ)</label>
          <input type="number" class="form-input" id="inpUSDTtoTMN" value="111900" inputmode="decimal" placeholder="ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
        </div>
        <div class="form-group">
          <label class="form-label">Ú©Ù…ÛŒØ³ÛŒÙˆÙ† Ø±Ø§Ø¨Ø· (ØªÙˆÙ…Ø§Ù† / CNY)</label>
          <input type="number" class="form-input" id="inpComm" value="5" inputmode="decimal">
        </div>
      </div>
      <div class="row-2">
        <div class="form-group">
          <label class="form-label">Ù…Ø³ÛŒØ± Ø®Ø±ÛŒØ¯</label>
          <select class="form-select" id="inpSource">
            <option value="sarafi">Ø¯Ù„Ø§Ø± ØµØ±Ø§ÙÛŒ</option>
            <option value="own">Ø¯Ù„Ø§Ø± Ø®ÙˆØ¯ØªØ§Ù†</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Ù†ÙˆØ¹ Ù¾Ø±Ø¯Ø§Ø®Øª</label>
          <select class="form-select" id="inpCurrency">
            <option value="TMN">ØªÙˆÙ…Ø§Ù†</option>
            <option value="USD">Ø¯Ù„Ø§Ø±</option>
          </select>
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">ÛŒØ§Ø¯Ø¯Ø§Ø´Øª (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)</label>
        <textarea class="form-textarea" id="inpNotes" rows="2" placeholder="Ù…Ø«Ù„Ø§Ù‹ Ù†Ø§Ù… Ø¯Ø§Ù†Ø´Ø¬ÙˆØŒ Ù…Ù„Ø§Ø­Ø¸Ø§Øª..."></textarea>
      </div>
    </div>

    <!-- Card 3: Calculation Results -->
    <div class="card col-12">
      <div class="card-title no-print">
        <span class="card-icon">ğŸ§®</span>
        Ù†ØªØ§ÛŒØ¬ Ù…Ø­Ø§Ø³Ø¨Ø§Øª
      </div>
      <div class="print-only" style="text-align: center; margin-bottom: 20px;">
        <h2 style="color: var(--primary);">Ú¯Ø²Ø§Ø±Ø´ Ù…Ø­Ø§Ø³Ø¨Ø§Øª ÙØ±ÙˆØ´ ÛŒÙˆØ¢Ù†</h2>
        <p style="color: var(--text-muted); font-size: 14px;">ØªØ§Ø±ÛŒØ®: <span id="printDate"></span></p>
        <p style="color: var(--text-muted); font-size: 12px; margin-top: 8px;">Ø·Ø±Ø§Ø­ÛŒ Ùˆ ØªÙˆØ³Ø¹Ù‡: Ø¹Ù„ÛŒØ±Ø¶Ø§ Ø­Ø§Ù…Ø¯</p>
      </div>
      <button class="btn btn-secondary no-print" id="btnCalc" style="width: 100%; margin-bottom: 16px;">
        ğŸ“ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù†Ø±Ø® Ù†Ù‡Ø§ÛŒÛŒ
      </button>
      <div class="result-box">
        <div class="result-label">Ù†Ø±Ø® ØªÙ…Ø§Ù…â€ŒØ´Ø¯Ù‡ Ø´Ù…Ø§ (Ø¨Ù‡Ø§ÛŒ ØªÙ…Ø§Ù… Ø´Ø¯Ù‡)</div>
        <div class="result-value" id="finalRate">â€” ØªÙˆÙ…Ø§Ù† / CNY</div>
        <div id="marketDiff"></div>
      </div>
      <table>
        <thead>
          <tr>
            <th>Ø´Ø±Ø­</th>
            <th>Ù…Ù‚Ø¯Ø§Ø±</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Ù…Ù‚Ø¯Ø§Ø± ÛŒÙˆØ¢Ù†</td>
            <td id="tdCNY">â€”</td>
          </tr>
          <tr>
            <td>ØªØªØ± Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²</td>
            <td id="tdUSDT">â€”</td>
          </tr>
          <tr>
            <td>Ù‡Ø²ÛŒÙ†Ù‡ Ù¾Ø§ÛŒÙ‡</td>
            <td id="tdBase">â€”</td>
          </tr>
          <tr>
            <td>Ú©Ù…ÛŒØ³ÛŒÙˆÙ† Ø±Ø§Ø¨Ø·</td>
            <td id="tdComm">â€”</td>
          </tr>
          <tr style="background: #F3F4F6; font-weight: 700;">
            <td>Ø¬Ù…Ø¹ Ù†Ù‡Ø§ÛŒÛŒ (Ø¨Ù‡Ø§ÛŒ ØªÙ…Ø§Ù… Ø´Ø¯Ù‡)</td>
            <td id="tdTotal">â€”</td>
          </tr>
        </tbody>
      </table>
      <div class="btn-group no-print" style="margin-top: 16px;">
        <button class="btn btn-outline" id="btnCopy">
          ğŸ“‹ Ú©Ù¾ÛŒ Ù†ØªØ§ÛŒØ¬
        </button>
        <button class="btn btn-outline" id="btnPrint">
          ğŸ–¨ï¸ Ú†Ø§Ù¾ Ù†ØªØ§ÛŒØ¬
        </button>
      </div>
    </div>

    <!-- Card 4: Competitive Rate Analysis -->
    <div class="card col-12">
      <div class="card-title">
        <span class="card-icon">ğŸ“ˆ</span>
        ØªØ­Ù„ÛŒÙ„ Ù†Ø±Ø® Ø±Ù‚Ø§Ø¨ØªÛŒ Ùˆ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³ÙˆØ¯/Ø²ÛŒØ§Ù†
      </div>
      <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 16px;">
        â„¹ï¸ Ø§Ø¨ØªØ¯Ø§ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø§ØµÙ„ÛŒ Ø±Ø§ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡ÛŒØ¯ ØªØ§ Ù†Ø±Ø® ØªÙ…Ø§Ù…â€ŒØ´Ø¯Ù‡ Ù…Ø´Ø®Øµ Ø´ÙˆØ¯ØŒ Ø³Ù¾Ø³ Ù†Ø±Ø® Ø±Ù‚ÛŒØ¨ Ùˆ Ù†Ø±Ø® Ø§Ø¹Ù„Ø§Ù…ÛŒ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.
      </p>
      <div class="row-3">
        <div class="form-group">
          <label class="form-label">Ù†Ø±Ø® ØªÙ…Ø§Ù…â€ŒØ´Ø¯Ù‡ Ø´Ù…Ø§ (Ø®ÙˆØ¯Ú©Ø§Ø±)</label>
          <input type="number" class="form-input" id="inpCostRate" readonly style="background: #F3F4F6;">
        </div>
        <div class="form-group">
          <label class="form-label">Ù†Ø±Ø® Ø±Ù‚ÛŒØ¨/Ø±Ø§Ø¨Ø· Ø¯Ø± ØµØ±Ø§ÙÛŒâ€ŒÙ‡Ø§ÛŒ Ú†ÛŒÙ†</label>
          <input type="number" class="form-input" id="inpCompetitorRate" value="0" inputmode="decimal" placeholder="Ù…Ø«Ù„Ø§Ù‹: 15700">
        </div>
        <div class="form-group">
          <label class="form-label">Ù†Ø±Ø® Ù‚Ø·Ø¹ÛŒ Ø§Ø¹Ù„Ø§Ù…ÛŒ Ø´Ù…Ø§ Ø¨Ù‡ Ø±Ø§Ø¨Ø·</label>
          <input type="number" class="form-input" id="inpFinalAnnouncedRate" value="0" inputmode="decimal" placeholder="Ù…Ø«Ù„Ø§Ù‹: 15800">
        </div>
      </div>
      <button class="btn btn-warning" id="btnAnalyze" style="width: 100%; margin-bottom: 16px;">
        ğŸ“Š ØªØ­Ù„ÛŒÙ„ Ù†Ø±Ø® Ø±Ù‚Ø§Ø¨ØªÛŒ
      </button>
      <div id="competitiveResults"></div>
    </div>

    <!-- Card 5: Save Order -->
    <div class="card col-12 no-print">
      <div class="card-title">
        <span class="card-icon">ğŸ’¾</span>
        Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´ Ø¯Ø± Google Sheet
      </div>
      <div class="row-2">
        <div class="form-group">
          <label class="form-label">ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´</label>
          <input type="text" class="form-input" id="inpStatus" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ù¾Ø±Ø¯Ø§Ø®Øª Ø´Ø¯Ù‡">
        </div>
        <div class="form-group">
          <label class="form-label">Ù…Ø¨Ù„Øº ÙˆØ§Ø±ÛŒØ²ÛŒ (ØªÙˆÙ…Ø§Ù†)</label>
          <input type="number" class="form-input" id="inpPaid" inputmode="decimal" placeholder="Ù…Ø«Ù„Ø§Ù‹: 95000000">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">ÛŒØ§Ø¯Ø¯Ø§Ø´Øª Ù†Ù‡Ø§ÛŒÛŒ</label>
        <textarea class="form-textarea" id="inpFinalNote" rows="2"></textarea>
      </div>
      <button class="btn btn-secondary" id="btnSave" style="width: 100%;">
        ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Google Sheet
      </button>
      <div id="sheetStatus" style="font-size: 12px; color: var(--text-muted); margin-top: 12px;">
        â„¹ï¸ ÙˆØ¶Ø¹ÛŒØª: Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡
      </div>
    </div>

    <!-- Card 6: Lock Rate -->
    <div class="card col-6 no-print">
      <div class="card-title">
        <span class="card-icon">ğŸ”’</span>
        Ù‚ÙÙ„ Ù†Ø±Ø®
      </div>
      <button class="btn btn-outline" id="btnLock" style="width: 100%;">
        ğŸ” Ù‚ÙÙ„ Ù†Ø±Ø® Ø¨Ø±Ø§ÛŒ 10 Ø¯Ù‚ÛŒÙ‚Ù‡
      </button>
      <p style="font-size: 12px; color: var(--text-muted); margin-top: 12px;">
        Ø¨Ø§ Ù‚ÙÙ„ Ù†Ø±Ø®ØŒ Ù…Ø­Ø§Ø³Ø¨Ø§Øª ØªØ§ Ø²Ù…Ø§Ù† Ù…Ø´Ø®Øµ Ù‚Ø§Ø¨Ù„ ØªØºÛŒÛŒØ± Ù†ÛŒØ³Øª.
      </p>
    </div>

    <!-- Card 7: History -->
    <div class="card col-6 no-print">
      <div class="card-title">
        <span class="card-icon">ğŸ“œ</span>
        ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù…Ø­Ø§Ø³Ø¨Ø§Øª
      </div>
      <div id="historyList" style="max-height: 200px; overflow-y: auto;">
        <p style="font-size: 13px; color: var(--text-muted);">Ù‡Ù†ÙˆØ² Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒØ§ÛŒ Ø§Ù†Ø¬Ø§Ù… Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
      </div>
      <button class="btn btn-outline" id="btnClearHistory" style="width: 100%; margin-top: 12px;">
        ğŸ—‘ï¸ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ØªØ§Ø±ÛŒØ®Ú†Ù‡
      </button>
    </div>
  </div>
</div>

<!-- Toast Notification -->
<div class="toast" id="toast">
  <span id="toastIcon">âœ…</span>
  <span id="toastMessage">Ø¹Ù…Ù„ÛŒØ§Øª Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯!</span>
</div>

<script>
const GSHEET_URL = "https://script.google.com/macros/s/AKfycbwBLZCsUiqK7QXl_5Cjg2WuEN2fLj4yVKIZN9VYbmfUrjqkEAbPz7hGB57i3kqjW-AgNg/exec";
const CORS_PROXY = "https://api.allorigins.win/raw?url=";

let state = {
  marketRate: null,
  lockedUntil: 0,
  history: JSON.parse(localStorage.getItem('calcHistory') || '[]'),
  costRate: 0
};

function $(id) { return document.getElementById(id); }
function num(v) { return parseFloat(v) || 0; }
function fmt(v, d = 0) { return isFinite(v) ? v.toLocaleString('fa-IR', { maximumFractionDigits: d }) : 'â€”'; }

// Clock
function updateClock() {
  const now = new Date();
  $('clock').textContent = now.toLocaleDateString('fa-IR') + ' - ' + now.toLocaleTimeString('fa-IR');
}
setInterval(updateClock, 1000);
updateClock();

// Toast
function showToast(message, icon = 'âœ…') {
  $('toastIcon').textContent = icon;
  $('toastMessage').textContent = message;
  $('toast').classList.add('show');
  setTimeout(() => $('toast').classList.remove('show'), 3000);
}

// Fetch Market Rate
async function fetchMarketRate() {
  $('btnFetch').disabled = true;
  const fetchIconEl = $('fetchIcon');
  fetchIconEl.innerHTML = '<div class="spinner"></div>';
  
  let price = null;
  let source = '';

  // Try Nobitex (direct - no CORS issue)
  try {
    const res = await fetch('https://api.nobitex.ir/market/stats?srcCurrency=usdt&dstCurrency=rls');
    const data = await res.json();
    if (data?.stats?.['usdt-rls']?.latest) {
      price = parseFloat(data.stats['usdt-rls'].latest) / 10;
      source = 'Ù†ÙˆØ¨ÛŒØªÚ©Ø³';
    }
  } catch (e) { 
    console.log('Nobitex error:', e); 
  }

  // Try Wallex with CORS proxy
  if (!price) {
    try {
      const res = await fetch(CORS_PROXY + encodeURIComponent('https://api.wallex.ir/v1/markets'));
      const data = await res.json();
      if (data?.result?.symbols?.USDTTMN?.stats?.lastPrice) {
        price = parseFloat(data.result.symbols.USDTTMN.stats.lastPrice);
        source = 'ÙˆØ§Ù„Ú©Ø³';
      }
    } catch (e) { 
      console.log('Wallex error:', e); 
    }
  }

  if (price) {
    state.marketRate = price;
    $('marketRate').textContent = fmt(price, 0) + ' ØªÙˆÙ…Ø§Ù†';
    $('marketSource').textContent = 'Ù…Ù†Ø¨Ø¹: ' + source;
    $('lastUpdate').textContent = 'Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: ' + new Date().toLocaleTimeString('fa-IR');
    showToast('Ù†Ø±Ø® Ø¨Ø§Ø²Ø§Ø± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯', 'âœ…');
  } else {
    $('marketRate').textContent = 'Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª';
    $('marketSource').textContent = 'Ø¹Ø¯Ù… Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ API';
    showToast('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù†Ø±Ø® Ø¨Ø§Ø²Ø§Ø±', 'âš ï¸');
  }

  $('btnFetch').disabled = false;
  fetchIconEl.textContent = 'ğŸ”„';
}

// Calculate
function calculate() {
  const CNY = num($('inpCNY').value);
  const rateCNY = num($('inpRateCNY').value);
  const USDTtoTMN = num($('inpUSDTtoTMN').value);
  const USDtoTMN = num($('inpUSDtoTMN').value);
  const USDtoUSDT = num($('inpUSDtoUSDT').value) || 1;
  const comm = num($('inpComm').value);
  const source = $('inpSource').value;

  if (USDTtoTMN === 0) {
    showToast('Ù„Ø·ÙØ§Ù‹ Ù†Ø±Ø® ØªØªØ± Ø¨Ù‡ ØªÙˆÙ…Ø§Ù† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'âš ï¸');
    return null;
  }

  const USDT_req = rateCNY > 0 ? CNY / rateCNY : 0;
  let baseCost;
  
  if (source === 'sarafi') {
    baseCost = (USDT_req * USDTtoTMN) + (comm * CNY);
  } else {
    const pricePerUSDT = USDtoTMN * USDtoUSDT;
    baseCost = (USDT_req * pricePerUSDT) + (comm * CNY);
  }

  const commTotal = comm * CNY;
  const costRatePerCNY = baseCost / CNY;

  state.costRate = costRatePerCNY;

  $('finalRate').textContent = fmt(costRatePerCNY, 0) + ' ØªÙˆÙ…Ø§Ù† / CNY';
  $('tdCNY').textContent = fmt(CNY, 0) + ' CNY';
  $('tdUSDT').textContent = fmt(USDT_req, 6) + ' USDT';
  $('tdBase').textContent = fmt(baseCost - commTotal, 0) + ' ØªÙˆÙ…Ø§Ù†';
  $('tdComm').textContent = fmt(commTotal, 0) + ' ØªÙˆÙ…Ø§Ù†';
  $('tdTotal').textContent = fmt(baseCost, 0) + ' ØªÙˆÙ…Ø§Ù†';
  $('inpCostRate').value = Math.round(costRatePerCNY);

  // Market difference
  if (state.marketRate) {
    const diff = ((USDTtoTMN - state.marketRate) / state.marketRate) * 100;
    let badge = '';
    if (diff > 2) {
      badge = `<span class="status-badge status-danger">ğŸš¨ ${fmt(diff, 2)}% Ø¨Ø§Ù„Ø§ØªØ± Ø§Ø² Ø¨Ø§Ø²Ø§Ø±</span>`;
    } else if (diff < -2) {
      badge = `<span class="status-badge status-success">âœ… ${fmt(Math.abs(diff), 2)}% Ú©Ù…ØªØ± Ø§Ø² Ø¨Ø§Ø²Ø§Ø±</span>`;
    } else {
      badge = `<span class="status-badge status-success">âœ… ØªÙØ§ÙˆØª: ${fmt(diff, 2)}%</span>`;
    }
    $('marketDiff').innerHTML = badge;
  }

  // Add to history
  const historyItem = {
    time: new Date().toLocaleString('fa-IR'),
    CNY: CNY,
    rate: Math.round(costRatePerCNY),
    total: Math.round(baseCost)
  };
  state.history.unshift(historyItem);
  if (state.history.length > 10) state.history.pop();
  localStorage.setItem('calcHistory', JSON.stringify(state.history));
  renderHistory();

  showToast('Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯', 'ğŸ§®');

  return {
    CNY, 
    rateCNY, 
    USDTtoTMN, 
    costRate: Math.round(costRatePerCNY),
    total: Math.round(baseCost), 
    comm: Math.round(commTotal),
    notes: $('inpNotes').value || ''
  };
}

// Analyze Competitive Rate
function analyzeCompetitive() {
  if (state.costRate === 0) {
    showToast('Ø§Ø¨ØªØ¯Ø§ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø§ØµÙ„ÛŒ Ø±Ø§ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡ÛŒØ¯', 'âš ï¸');
    return;
  }

  const costRate = state.costRate;
  const competitorRate = num($('inpCompetitorRate').value);
  const announcedRate = num($('inpFinalAnnouncedRate').value);
  const CNY = num($('inpCNY').value);

  if (competitorRate === 0 || announcedRate === 0) {
    showToast('Ù„Ø·ÙØ§Ù‹ Ù†Ø±Ø® Ø±Ù‚ÛŒØ¨ Ùˆ Ù†Ø±Ø® Ø§Ø¹Ù„Ø§Ù…ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'âš ï¸');
    return;
  }

  // Ù…Ø­Ø§Ø³Ø¨Ø§Øª
  const profitVsCost = (announcedRate - costRate) * CNY;
  const profitVsCompetitor = (announcedRate - competitorRate) * CNY;
  const profitPercentVsCost = ((announcedRate - costRate) / costRate) * 100;
  const profitPercentVsCompetitor = ((announcedRate - competitorRate) / competitorRate) * 100;
  
  const isCompetitive = announcedRate <= competitorRate;
  const isProfitable = announcedRate > costRate;

  let html = `
    <div class="competitive-box ${isProfitable ? 'profit' : 'loss'}">
      <h4 style="margin-bottom: 12px; color: var(--text);">Ù†ØªÛŒØ¬Ù‡ ØªØ­Ù„ÛŒÙ„ Ù†Ø³Ø¨Øª Ø¨Ù‡ Ø¨Ù‡Ø§ÛŒ ØªÙ…Ø§Ù… Ø´Ø¯Ù‡</h4>
      <table style="margin: 0;">
        <tr>
          <td>Ø³ÙˆØ¯/Ø²ÛŒØ§Ù† (ØªÙˆÙ…Ø§Ù†)</td>
          <td style="font-weight: 700; color: ${isProfitable ? 'var(--secondary)' : 'var(--danger)'};">
            ${isProfitable ? 'âœ…' : 'âŒ'} ${fmt(profitVsCost, 0)} ØªÙˆÙ…Ø§Ù†
          </td>
        </tr>
        <tr>
          <td>Ø¯Ø±ØµØ¯ Ø³ÙˆØ¯/Ø²ÛŒØ§Ù†</td>
          <td style="font-weight: 700;">
            ${fmt(profitPercentVsCost, 2)}%
          </td>
        </tr>
      </table>
    </div>

    <div class="competitive-box ${isCompetitive ? 'profit' : 'loss'}" style="margin-top: 12px;">
      <h4 style="margin-bottom: 12px; color: var(--text);">Ù†ØªÛŒØ¬Ù‡ ØªØ­Ù„ÛŒÙ„ Ù†Ø³Ø¨Øª Ø¨Ù‡ Ù†Ø±Ø® Ø±Ù‚ÛŒØ¨</h4>
      <table style="margin: 0;">
        <tr>
          <td>Ø§Ø®ØªÙ„Ø§Ù Ø¨Ø§ Ø±Ù‚ÛŒØ¨ (ØªÙˆÙ…Ø§Ù†)</td>
          <td style="font-weight: 700;">
            ${fmt(profitVsCompetitor, 0)} ØªÙˆÙ…Ø§Ù†
          </td>
        </tr>
        <tr>
          <td>Ø¯Ø±ØµØ¯ Ø§Ø®ØªÙ„Ø§Ù</td>
          <td style="font-weight: 700;">
            ${fmt(profitPercentVsCompetitor, 2)}%
          </td>
        </tr>
        <tr>
          <td>ÙˆØ¶Ø¹ÛŒØª Ø±Ù‚Ø§Ø¨ØªÛŒ</td>
          <td style="font-weight: 700; color: ${isCompetitive ? 'var(--secondary)' : 'var(--danger)'};">
            ${isCompetitive ? 'âœ… Ø±Ù‚Ø§Ø¨ØªÛŒ (Ù†Ø±Ø® Ø´Ù…Ø§ Ú©Ù…ØªØ± ÛŒØ§ Ø¨Ø±Ø§Ø¨Ø±)' : 'âš ï¸ ØºÛŒØ± Ø±Ù‚Ø§Ø¨ØªÛŒ (Ù†Ø±Ø® Ø´Ù…Ø§ Ø¨Ø§Ù„Ø§ØªØ±)'}
          </td>
        </tr>
      </table>
    </div>

    <div style="background: var(--bg); padding: 16px; border-radius: 12px; margin-top: 12px;">
      <h4 style="margin-bottom: 12px; color: var(--text);">Ø®Ù„Ø§ØµÙ‡</h4>
      <ul style="margin: 0; padding-right: 20px; font-size: 14px; line-height: 2;">
        <li><strong>Ù†Ø±Ø® ØªÙ…Ø§Ù… Ø´Ø¯Ù‡ Ø´Ù…Ø§:</strong> ${fmt(costRate, 0)} ØªÙˆÙ…Ø§Ù†/CNY</li>
        <li><strong>Ù†Ø±Ø® Ø±Ù‚ÛŒØ¨:</strong> ${fmt(competitorRate, 0)} ØªÙˆÙ…Ø§Ù†/CNY</li>
        <li><strong>Ù†Ø±Ø® Ø§Ø¹Ù„Ø§Ù…ÛŒ Ø´Ù…Ø§:</strong> ${fmt(announcedRate, 0)} ØªÙˆÙ…Ø§Ù†/CNY</li>
        <li><strong>Ù†ØªÛŒØ¬Ù‡ Ù†Ù‡Ø§ÛŒÛŒ:</strong> 
          ${isProfitable ? 'âœ… Ø³ÙˆØ¯Ø¢ÙˆØ±' : 'âŒ Ø²ÛŒØ§Ù†â€ŒØ¯Ù‡'} Ùˆ 
          ${isCompetitive ? 'âœ… Ø±Ù‚Ø§Ø¨ØªÛŒ' : 'âš ï¸ ØºÛŒØ± Ø±Ù‚Ø§Ø¨ØªÛŒ'}
        </li>
      </ul>
    </div>
  `;

  $('competitiveResults').innerHTML = html;
  showToast('ØªØ­Ù„ÛŒÙ„ Ø±Ù‚Ø§Ø¨ØªÛŒ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯', 'ğŸ“Š');
}

// Render History
function renderHistory() {
  const html = state.history.length > 0
    ? state.history.map(h => `
        <div class="history-item">
          <div><strong>${fmt(h.CNY)} ÛŒÙˆØ¢Ù†</strong> â†’ ${fmt(h.rate)} ØªÙˆÙ…Ø§Ù†/CNY</div>
          <div class="time">${h.time} - Ø¬Ù…Ø¹: ${fmt(h.total)} ØªÙˆÙ…Ø§Ù†</div>
        </div>
      `).join('')
    : '<p style="font-size: 13px; color: var(--text-muted);">Ù‡Ù†ÙˆØ² Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒØ§ÛŒ Ø§Ù†Ø¬Ø§Ù… Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>';
  $('historyList').innerHTML = html;
}
renderHistory();

// Lock Rate
function lockRate(minutes) {
  state.lockedUntil = Date.now() + (minutes * 60000);
  $('btnLock').textContent = `ğŸ”’ Ù‚ÙÙ„ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ${minutes} Ø¯Ù‚ÛŒÙ‚Ù‡`;
  $('btnLock').disabled = true;
  setTimeout(() => {
    $('btnLock').textContent = 'ğŸ” Ù‚ÙÙ„ Ù†Ø±Ø® Ø¨Ø±Ø§ÛŒ 10 Ø¯Ù‚ÛŒÙ‚Ù‡';
    $('btnLock').disabled = false;
    showToast('Ù‚ÙÙ„ Ù†Ø±Ø® Ø¨Ø±Ø¯Ø§Ø´ØªÙ‡ Ø´Ø¯', 'ğŸ”“');
  }, minutes * 60000);
  showToast(`Ù†Ø±Ø® Ø¨Ø±Ø§ÛŒ ${minutes} Ø¯Ù‚ÛŒÙ‚Ù‡ Ù‚ÙÙ„ Ø´Ø¯`, 'ğŸ”’');
}

// Save to Google Sheet
async function saveToSheet() {
  const payload = calculate();
  if (!payload) return;
  
  payload.status = $('inpStatus').value || 'Ø«Ø¨Øª Ø¯Ø³ØªÛŒ';
  payload.notes = $('inpFinalNote').value || payload.notes;
  payload.paidAmount = num($('inpPaid').value);
  payload.competitorRate = num($('inpCompetitorRate').value);
  payload.announcedRate = num($('inpFinalAnnouncedRate').value);

  $('btnSave').disabled = true;
  $('btnSave').textContent = 'â³ Ø¯Ø± Ø­Ø§Ù„ Ø°Ø®ÛŒØ±Ù‡...';
  $('sheetStatus').textContent = 'â³ Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Google Sheet...';
  $('sheetStatus').style.color = 'var(--warning)';

  try {
    const res = await fetch(GSHEET_URL, {
      method: 'POST',
      mode: 'no-cors',
      headers: { 
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(payload)
    });
    
    // Ø¯Ø± Ø­Ø§Ù„Øª no-cors Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒÙ… response Ø±Ø§ Ø¨Ø®ÙˆØ§Ù†ÛŒÙ…ØŒ Ù¾Ø³ ÙØ±Ø¶ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯Ù‡
    showToast('Ø³ÙØ§Ø±Ø´ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯', 'âœ…');
    $('sheetStatus').textContent = 'âœ… Ø°Ø®ÛŒØ±Ù‡ Ù…ÙˆÙÙ‚ - Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø± Google Sheet Ø«Ø¨Øª Ø´Ø¯';
    $('sheetStatus').style.color = 'var(--secondary)';
    
    setTimeout(() => {
      location.reload();
    }, 2000);
    
  } catch (err) {
    console.error('Error:', err);
    showToast('Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Google Sheet', 'âŒ');
    $('sheetStatus').textContent = 'âŒ Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ - Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯';
    $('sheetStatus').style.color = 'var(--danger)';
    $('btnSave').disabled = false;
    $('btnSave').textContent = 'ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Google Sheet';
  }
}

// Copy Results
function copyResults() {
  const text = `
Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒÚ¯Ø± ÛŒÙˆØ¢Ù† - Ø¹Ù„ÛŒØ±Ø¶Ø§ Ø­Ø§Ù…Ø¯
Ù…Ù‚Ø¯Ø§Ø±: ${$('inpCNY').value} CNY
Ù†Ø±Ø® ØªÙ…Ø§Ù… Ø´Ø¯Ù‡: ${$('finalRate').textContent}
Ø¬Ù…Ø¹ Ú©Ù„: ${$('tdTotal').textContent}
ØªØ§Ø±ÛŒØ®: ${new Date().toLocaleString('fa-IR')}
  `.trim();
  navigator.clipboard.writeText(text);
  showToast('Ù†ØªØ§ÛŒØ¬ Ú©Ù¾ÛŒ Ø´Ø¯', 'ğŸ“‹');
}

// Print
function printResults() {
  $('printDate').textContent = new Date().toLocaleString('fa-IR');
  window.print();
}

// Event Listeners
$('btnFetch').addEventListener('click', fetchMarketRate);
$('btnCalc').addEventListener('click', () => {
  if (state.lockedUntil && Date.now() < state.lockedUntil) {
    showToast('Ù†Ø±Ø® Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ù‚ÙÙ„ Ø§Ø³Øª', 'ğŸ”’');
    return;
  }
  calculate();
});
$('btnAnalyze').addEventListener('click', analyzeCompetitive);
$('btnReset').addEventListener('click', () => {
  if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')) location.reload();
});
$('btnLock').addEventListener('click', () => lockRate(10));
$('btnSave').addEventListener('click', saveToSheet);
$('btnCopy').addEventListener('click', copyResults);
$('btnPrint').addEventListener('click', printResults);
$('btnClearHistory').addEventListener('click', () => {
  if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')) {
    state.history = [];
    localStorage.removeItem('calcHistory');
    renderHistory();
    showToast('ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù¾Ø§Ú© Ø´Ø¯', 'ğŸ—‘ï¸');
  }
});

// Auto-update market rate every 2 minutes
setInterval(fetchMarketRate, 120000);

// Initial fetch
window.addEventListener('load', fetchMarketRate);
</script>
</body>
</html>